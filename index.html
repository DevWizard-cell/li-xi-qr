<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>L√¨ X√¨ 2027</title>

<style>
*{margin:0;padding:0;box-sizing:border-box;}
body{
font-family:-apple-system,BlinkMacSystemFont,sans-serif;
background:radial-gradient(circle at top,#ff2a2a,#8b0000);
color:white;
min-height:100vh;
overflow:auto;
}

/* SCREEN */
.screen{
position:fixed;
inset:0;
display:flex;
flex-direction:column;
justify-content:center;
align-items:center;
text-align:center;
padding:20px;
}

input{
padding:12px;
border-radius:20px;
border:none;
width:80%;
max-width:300px;
margin-top:15px;
text-align:center;
font-size:16px;
}

button{
padding:10px 20px;
border:none;
border-radius:20px;
margin:10px;
font-weight:bold;
cursor:pointer;
}

.primary{background:gold;color:black;}
.secondary{background:white;color:black;}
.hidden{display:none}

/* GRID */
.grid{
display:grid;
grid-template-columns:repeat(3,1fr);
gap:14px;
padding:20px;
max-width:500px;
margin:auto;
max-height:75vh;
overflow-y:auto;
}

.item{text-align:center;}
.lixi{
width:100%;
border-radius:16px;
cursor:pointer;
transition:0.3s;
box-shadow:0 4px 10px rgba(0,0,0,0.4);
}
.lixi:hover{transform:scale(1.08);}

/* OVERLAY */
.overlay{
position:fixed;
inset:0;
background:rgba(0,0,0,0.8);
display:flex;
justify-content:center;
align-items:center;
flex-direction:column;
visibility:hidden;
opacity:0;
transition:0.3s;
}
.overlay.show{visibility:visible;opacity:1;}

.preview{
background:rgba(255,255,255,0.1);
padding:25px;
border-radius:25px;
text-align:center;
max-width:320px;
backdrop-filter:blur(10px);
}

.preview img{
width:180px;
border-radius:15px;
margin-bottom:12px;
}

.notice{
margin-top:10px;
font-size:14px;
opacity:0.85;
}

canvas{
position:fixed;
top:0;
left:0;
pointer-events:none;
}

/* VIEW MODE */
#viewMode img{
position:absolute;
cursor:grab;
max-width:none;
}
.view-btn{
position:fixed;
right:20px;
background:gold;
border:none;
padding:8px 12px;
border-radius:10px;
font-weight:bold;
}
</style>
</head>
<body>

<div class="screen" id="nameScreen">
<h2>üéâ Nh·∫≠p t√™n c·ªßa b·∫°n</h2>
<input id="username" placeholder="Nh·∫≠p t√™n t·∫°i ƒë√¢y">
<button class="primary" onclick="start()">B·∫Øt ƒë·∫ßu</button>
</div>

<div id="chooseScreen" class="hidden">
<h3 style="text-align:center;margin-top:15px;">üßß Ch·ªçn m·ªôt l√¨ x√¨ b·∫°n th√≠ch</h3>
<div class="grid" id="grid"></div>
</div>

<div class="overlay" id="overlay" onclick="closeOverlay(event)">
<div class="preview" onclick="event.stopPropagation()">
<img id="previewImg">
<h3 id="themeTitle"></h3>
<p id="finalWish"></p>
<div id="actionArea"></div>
</div>
</div>

<div class="overlay" id="downloadConfirm">
<div class="preview">
<h3>B·∫°n c√≥ ch·∫Øc mu·ªën t·∫£i l√¨ x√¨ n√†y?</h3>
<button class="primary" onclick="confirmDownload()">C√≥</button>
<button class="secondary" onclick="closeDownload()">Kh√¥ng</button>
</div>
</div>

<div class="overlay" id="viewMode">
<img id="viewImg">
<button class="view-btn" style="top:40%;" onclick="zoomIn()">+</button>
<button class="view-btn" style="top:50%;" onclick="zoomOut()">-</button>
<button style="position:fixed;top:15px;right:15px;background:red;color:white;border:none;padding:8px 12px;border-radius:10px;" onclick="closeView()">X</button>
</div>

<canvas id="firework"></canvas>

<script>

/* ===== NH·∫†C N·ªÄN ===== */
const bgMusic=new Audio("music/tet.mp3");
bgMusic.loop=true;
bgMusic.volume=0;
let musicOn=false;
let fadeInterval=null;

const musicBtn=document.createElement("button");
musicBtn.innerHTML="üîä B·∫≠t nh·∫°c";
musicBtn.style.position="fixed";
musicBtn.style.top="15px";
musicBtn.style.left="15px";
musicBtn.style.zIndex="9999";
musicBtn.style.borderRadius="50%";
musicBtn.style.width="100px";
musicBtn.style.height="60px";
musicBtn.style.border="none";
musicBtn.style.fontSize="18px";
musicBtn.style.cursor="pointer";
musicBtn.style.background="gold";
musicBtn.style.color="black";
document.body.appendChild(musicBtn);

musicBtn.onclick=toggleMusic;

function toggleMusic(){
if(!musicOn){
bgMusic.play();
fadeInMusic();
musicBtn.innerHTML="üîá T·∫Øt nh·∫°c";
musicOn=true;
}else{
bgMusic.pause();
musicBtn.innerHTML="üîä B·∫≠t nh·∫°c";
musicOn=false;
}
}

function fadeInMusic(){
bgMusic.volume=0;
let step=0;
clearInterval(fadeInterval);
fadeInterval=setInterval(()=>{
step+=0.05;
if(step>=1){
bgMusic.volume=1;
clearInterval(fadeInterval);
}else{
bgMusic.volume=step;
}
},100);
}

document.addEventListener("visibilitychange",()=>{
if(document.hidden){
bgMusic.pause();
}else{
if(musicOn) bgMusic.play();
}
});

/* üîî BELL */
const bellSound=new Audio("audio/bell ring.mp3");
function playBell(){
bellSound.currentTime=0;
bellSound.play();
}

/* DATA */
const images=[
"images/Phong Bao L√¨ X√¨ ·∫¢nh 1 ƒê·ªè Nay.png",
"images/Phong Bao L√¨ X√¨ ·∫¢nh 2 Cam H·ªìng Nay Nay.png",
"images/Phong Bao L√¨ X√¨ ·∫¢nh 3 Xanh Bi·ªÉn ƒê·∫≠m.png",
"images/Phong Bao L√¨ X√¨ ·∫¢nh 4 ƒê·ªè X∆∞a.png",
"images/Phong Bao L√¨ X√¨ ·∫¢nh 5 V√†ng X∆∞a.png",
"images/Phong Bao L√¨ X√¨ ·∫¢nh 6 Lam X∆∞a.png",
"images/Phong Bao L√¨ X√¨ ·∫¢nh 7 T·∫øt R·ªôn R√†ng.png",
"images/Phong Bao L√¨ X√¨ ·∫¢nh 8 Gen Z.png",
"images/Phong Bao L√¨ X√¨ ·∫¢nh 9 Th∆∞ Ph√°p.png"
];

const themes=[
"üí∞ Ch·ªß ƒë·ªÅ T√†i L·ªôc","üî• Ch·ªß ƒë·ªÅ B·ª©t Ph√°","üåä Ch·ªß ƒë·ªÅ Th√†nh C√¥ng",
"üèÆ Ch·ªß ƒë·ªÅ Truy·ªÅn Th·ªëng","‚ú® Ch·ªß ƒë·ªÅ V√†ng Son","üß† Ch·ªß ƒë·ªÅ N·ªôi L·ª±c",
"üéä Ch·ªß ƒë·ªÅ R·ªôn R√†ng","üöÄ Ch·ªß ƒë·ªÅ Gen Z","üìú Ch·ªß ƒë·ªÅ Th∆∞ Ph√°p"
];

const wishes=[
[
  "NƒÉm m·ªõi r·ª±c r·ª° nh∆∞ s·∫Øc ƒë·ªè, ti·ªÅn v√¥ nh∆∞ n∆∞·ªõc.",
  "Ch√∫c b·∫°n c·∫£ nƒÉm may m·∫Øn ƒë·ªè th·∫Øm, l√†m ƒë√¢u th·∫Øng ƒë√≥.",
  "T·∫øt n√†y ƒë·ªè v·∫≠n, c·∫£ nƒÉm ph√°t t√†i ph√°t l·ªôc.",
  "An khang th·ªãnh v∆∞·ª£ng, v·∫°n s·ª± hanh th√¥ng.",
  "Xu√¢n sang ph√∫ qu√Ω, l·ªôc l√° ƒë·∫ßy nh√†.",
  "ƒê·ªè t√¨nh ƒë·ªè ti·ªÅn, ƒë·ªè lu√¥n c·∫£ s·ª± nghi·ªáp.",
  "Gia ƒë√¨nh ·∫•m √™m, c√¥ng vi·ªác thu·∫≠n l·ª£i.",
  "M·ªôt nƒÉm b·ª©t ph√°, th√†nh c√¥ng r·ª±c r·ª°."
],
[
  "NƒÉm m·ªõi ng·ªçt ng√†o nh∆∞ s·∫Øc cam h·ªìng, t√¨nh ti·ªÅn ƒë·ªß ƒë·∫ßy.",
  "Ch√∫c b·∫°n y√™u ƒë·ªùi, y√™u ng∆∞·ªùi, y√™u lu√¥n v√≠ ti·ªÅn.",
  "T·∫øt ƒë·∫øn h·∫°nh ph√∫c lan t·ªèa kh·∫Øp n∆°i.",
  "S·ª± nghi·ªáp thƒÉng hoa, t√†i l·ªôc n·ªü r·ªô.",
  "Gia ƒë√¨nh sum v·∫ßy, ni·ªÅm vui tr√≤n ƒë·∫ßy.",
  "M·ªói ng√†y ƒë·ªÅu l√† m·ªôt ng√†y may m·∫Øn.",
  "Th√†nh c√¥ng n·ªëi ti·∫øp th√†nh c√¥ng.",
  "C∆∞·ªùi t∆∞∆°i c·∫£ nƒÉm, ph√°t t√†i c·∫£ th√°ng."
],
[
  "Ch√∫c nƒÉm m·ªõi b√¨nh an s√¢u l·∫Øng nh∆∞ bi·ªÉn c·∫£.",
  "T√†i l·ªôc d·ªìi d√†o, s·ª± nghi·ªáp v·ªØng v√†ng.",
  "V∆∞·ª£t s√≥ng th√†nh c√¥ng, c·∫≠p b·∫øn vinh quang.",
  "Gia ƒë·∫°o an nhi√™n, t√¢m h·ªìn th∆∞ th√°i.",
  "L√†m ƒÉn thu·∫≠n bu·ªìm xu√¥i gi√≥.",
  "M·ªçi d·ª± ƒë·ªãnh ƒë·ªÅu th√†nh hi·ªán th·ª±c.",
  "B·∫£n lƒ©nh m·∫°nh m·∫Ω, v∆∞∆°n xa b·ªën ph∆∞∆°ng.",
  "M·ªôt nƒÉm ·ªïn ƒë·ªãnh v√† ƒë·∫ßy b·ª©t ph√°."
],
[
  "Xu√¢n v·ªÅ mang l·ªôc c·ªï truy·ªÅn, ph√∫c ƒë·ª©c ƒë·∫ßy nh√†.",
  "Ch√∫c gia ƒë√¨nh h√≤a thu·∫≠n, ·∫•m √™m tr·ªçn nƒÉm.",
  "Ph√∫ qu√Ω song to√†n, an khang th·ªãnh ƒë·∫°t.",
  "T√†i l·ªôc t·∫•n t·ªõi, v·∫°n s·ª± nh∆∞ √Ω.",
  "K√≠nh ch√∫c s·ª©c kh·ªèe d·ªìi d√†o, tinh th·∫ßn minh m·∫´n.",
  "Con ch√°u hi·∫øu thu·∫≠n, gia ƒë·∫°o y√™n vui.",
  "L√†m ƒÉn ph√°t ƒë·∫°t, ti·ªÅn v√¥ nh∆∞ n∆∞·ªõc.",
  "Xu√¢n an vui, T·∫øt ƒë·∫≠m t√¨nh th√¢n."
],
[
  "NƒÉm m·ªõi v√†ng son, ph√∫ qu√Ω ƒë·∫ßy tay.",
  "T√†i l·ªôc s√°ng r·ª±c nh∆∞ s·∫Øc v√†ng ƒë·∫ßu xu√¢n.",
  "Ch√∫c b·∫°n c√¥ng danh r·∫°ng r·ª°.",
  "Gia ƒë√¨nh sung t√∫c, ƒë·ªß ƒë·∫ßy quanh nƒÉm.",
  "May m·∫Øn g√µ c·ª≠a, th√†nh c√¥ng ch·ªù s·∫µn.",
  "S·ª± nghi·ªáp thƒÉng ti·∫øn kh√¥ng ng·ª´ng.",
  "Ti·ªÅn v√†o nh∆∞ n∆∞·ªõc, ti·ªÅn ra nh·ªè gi·ªçt.",
  "M·ªôt nƒÉm ph√°t t√†i ph√°t l·ªôc."
],
[
  "Ch√∫c nƒÉm m·ªõi b√¨nh an v√† s√¢u s·∫Øc.",
  "T√¢m an v·∫°n s·ª± an.",
  "S·ª± nghi·ªáp v·ªØng b·ªÅn nh∆∞ tr·ªùi xanh.",
  "Gia ƒë√¨nh h√≤a h·ª£p, h·∫°nh ph√∫c d√†i l√¢u.",
  "Kh·ªüi ƒë·∫ßu thu·∫≠n l·ª£i, k·∫øt th√∫c vi√™n m√£n.",
  "May m·∫Øn b·ªÅn l√¢u, th√†nh c√¥ng ch·∫Øc ch·∫Øn.",
  "S·ª©c kh·ªèe d·ªìi d√†o, tinh th·∫ßn minh m·∫´n.",
  "M·ªôt nƒÉm an nhi√™n, ƒë·ªß ƒë·∫ßy."
],
[
  "T·∫øt r·ªôn r√†ng, l·ªôc ƒë·∫øn ng·∫≠p tr√†n.",
  "NƒÉm m·ªõi t∆∞ng b·ª´ng, ti·ªÅn v√¥ √†o √†o.",
  "C·∫£ nƒÉm c∆∞·ªùi t∆∞∆°i nh∆∞ ph√°o hoa.",
  "Gia ƒë√¨nh sum h·ªçp, h·∫°nh ph√∫c nh√¢n ƒë√¥i.",
  "L√†m ƒÉn ph√°t ƒë·∫°t, kh√°ch h√†ng ƒë√¥ng vui.",
  "May m·∫Øn li√™n h·ªìi, th√†nh c√¥ng n·ªëi ti·∫øp.",
  "Xu√¢n sang v·∫°n s·ª± nh∆∞ √Ω.",
  "M·ªôt nƒÉm b√πng n·ªï m·ªçi m·ª•c ti√™u."
],
[
  "NƒÉm m·ªõi chill h·∫øt n·∫•c, ti·ªÅn v·ªÅ c·ª±c ch·∫•t.",
  "Ch√∫c b·∫°n flex nh·∫π m√† th√†nh c√¥ng ƒë·∫≠m.",
  "T·∫øt n√†y v√≠ d√†y, mood lu√¥n high.",
  "S·ª± nghi·ªáp l√™n level, t√¨nh y√™u full pin.",
  "2027 b·ª©t t·ªëc, kh√¥ng g√¨ c·∫£n n·ªïi.",
  "H·∫øt deadline, full timeline h·∫°nh ph√∫c.",
  "L√†m √≠t h∆∞·ªüng nhi·ªÅu, l·ªôc t·ªõi li·ªÅn tay.",
  "NƒÉm m·ªõi slay, c·∫£ nƒÉm okay."
],
[
  "T√¢n xu√¢n kh√°nh h·ª∑, ph√∫c l·ªôc tr√πng lai.",
  "Xu√¢n ƒë√°o nh√¢n gian, v·∫°n s·ª± c√°t t∆∞·ªùng.",
  "Ni√™n ni√™n nh∆∞ √Ω, tu·∫ø tu·∫ø b√¨nh an.",
  "T√¢n ni√™n n·∫°p ph√∫c, b√°ch s·ª± thu·∫≠n th√†nh.",
  "Xu√¢n phong t·ªëng ph√∫c, h·ª∑ kh√≠ l√¢m m√¥n.",
  "Khai ni√™n ƒë·∫°i c√°t, ph√∫ qu√Ω tr∆∞·ªùng t·ªìn.",
  "Xu√¢n nh·∫≠t an khang, gia h√≤a h∆∞ng th·ªãnh.",
  "Ng≈© ph√∫c l√¢m m√¥n, t√†i l·ªôc song to√†n."
]
];

let selectedIndex=null;
let userName="";
let claimed=false;

function start(){
const name=document.getElementById("username").value.trim();
if(!name) return alert("Vui l√≤ng nh·∫≠p t√™n");
userName=name;
document.getElementById("nameScreen").classList.add("hidden");
document.getElementById("chooseScreen").classList.remove("hidden");
renderGrid();
}

function renderGrid(){
const grid=document.getElementById("grid");
grid.innerHTML="";
images.forEach((src,index)=>{
const div=document.createElement("div");
div.className="item";
const img=document.createElement("img");
img.src=src;
img.className="lixi";
img.onclick=()=>preview(index);
div.appendChild(img);
grid.appendChild(div);
});
}

function preview(index){
selectedIndex=index;
document.getElementById("overlay").classList.add("show");
document.getElementById("previewImg").src=images[index];
document.getElementById("themeTitle").innerText=themes[index];
document.getElementById("finalWish").innerText="";

if(claimed){
document.getElementById("actionArea").innerHTML=
`<div class="notice">B·∫°n ƒë√£ nh·∫≠n l√¨ x√¨ r·ªìi</div>
<button class="primary" onclick="showDownload()">T·∫£i v·ªÅ</button>
<button class="secondary" onclick="openView()">Xem l√¨ x√¨</button>`;
}else{
document.getElementById("actionArea").innerHTML=
`<button class="primary" onclick="keepLixi()">Gi·ªØ l√¨ x√¨</button>
<button class="secondary" onclick="changeLixi()">ƒê·ªïi l√¨ x√¨</button>`;
}
}

function keepLixi(){
if(claimed) return;
playBell();
const wish=wishes[selectedIndex][Math.floor(Math.random()*2)];
document.getElementById("finalWish").innerText=userName+", "+wish;
claimed=true;
document.getElementById("actionArea").innerHTML=
`<div class="notice">B·∫°n ƒë√£ nh·∫≠n l√¨ x√¨ r·ªìi</div>
<button class="primary" onclick="showDownload()">T·∫£i v·ªÅ</button>
<button class="secondary" onclick="openView()">Xem l√¨ x√¨</button>`;
launchFirework();
}

function changeLixi(){
document.getElementById("overlay").classList.remove("show");
}

function closeOverlay(e){
if(e.target.id==="overlay"){
document.getElementById("overlay").classList.remove("show");
}
}

/* DOWNLOAD */
function showDownload(){
document.getElementById("downloadConfirm").classList.add("show");
}
function closeDownload(){
document.getElementById("downloadConfirm").classList.remove("show");
}
function confirmDownload(){
let link=document.createElement("a");
link.href=images[selectedIndex];
link.download="lixi.png";
link.click();
closeDownload();
}

/* VIEW MODE */
let scale=1,posX=0,posY=0,isDragging=false,startX,startY;
function openView(){
document.getElementById("viewMode").classList.add("show");
const img=document.getElementById("viewImg");
img.src=images[selectedIndex];
scale=1;posX=0;posY=0;
updateTransform();
}
function closeView(){
document.getElementById("viewMode").classList.remove("show");
}
function zoomIn(){scale+=0.2;updateTransform();}
function zoomOut(){if(scale>0.4){scale-=0.2;updateTransform();}}
function updateTransform(){
const img=document.getElementById("viewImg");
img.style.transform=`translate(${posX}px,${posY}px) scale(${scale})`;
}

const viewImg=document.getElementById("viewImg");
viewImg.addEventListener("mousedown",e=>{
isDragging=true;
startX=e.clientX-posX;
startY=e.clientY-posY;
});
window.addEventListener("mousemove",e=>{
if(!isDragging)return;
posX=e.clientX-startX;
posY=e.clientY-startY;
updateTransform();
});
window.addEventListener("mouseup",()=>{isDragging=false;});
viewImg.addEventListener("touchstart",e=>{
isDragging=true;
startX=e.touches[0].clientX-posX;
startY=e.touches[0].clientY-posY;
});
viewImg.addEventListener("touchmove",e=>{
if(!isDragging)return;
posX=e.touches[0].clientX-startX;
posY=e.touches[0].clientY-startY;
updateTransform();
});
viewImg.addEventListener("touchend",()=>{isDragging=false;});

/* FIREWORK */
const canvas=document.getElementById("firework");
const ctx=canvas.getContext("2d");
canvas.width=window.innerWidth;
canvas.height=window.innerHeight;

function launchFirework(){
if(musicOn){
bgMusic.volume=0.3;
setTimeout(()=>{bgMusic.volume=1;},1500);
}
let particles=[];
for(let i=0;i<100;i++){
particles.push({
x:Math.random()*canvas.width,
y:canvas.height,
angle:-Math.PI/2+(Math.random()-0.5),
speed:Math.random()*6+3,
life:60
});
}
function animate(){
ctx.clearRect(0,0,canvas.width,canvas.height);
particles.forEach(p=>{
p.x+=Math.cos(p.angle)*p.speed;
p.y+=Math.sin(p.angle)*p.speed;
p.life--;
ctx.fillStyle="hsl("+Math.random()*360+",100%,60%)";
ctx.beginPath();
ctx.arc(p.x,p.y,3,0,Math.PI*2);
ctx.fill();
});
particles=particles.filter(p=>p.life>0);
if(particles.length>0){
requestAnimationFrame(animate);
}else{
ctx.clearRect(0,0,canvas.width,canvas.height);
}
}
animate();
}

</script>
</body>
</html>
